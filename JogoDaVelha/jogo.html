<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <title>Jogo da Velha</title>
        
        <link rel="stylesheet" type="text/css" href="CSS/style.css" />
        
        <script type="text/javascript" src="JS/jquery-3.4.1.min.js"> </script>
        
        <script type="text/javascript">
            var interval = null;
            $(document).ready(function(){
                //validação do preenchimento
                $("#btn_comecar").click(function(){
                    var jog1 = $("input[name=jogador1]").val();
                    var jog2 = $("input[name=jogador2]").val();
                    
                    if( jog1.trim().length > 0 && jog2.trim().length > 0) {
                        //Começar o jogo
                        $(".msg").text("");
                        ComecarJogo();       
                    }else{
                        $(".msg").text("Nome(s) não preenchidos");
                    }
                })
            })
            
          function ComecarJogo(){
              var contadorClicks = 0;
              
              interval = setInterval(tempodecorrido, 500);
              
              $("table td").click(function(){
                  contadorClicks++;
                  
                  
                  if (contadorClicks <= 9){
                      if (contadorClicks % 2 == 0){
                          //PAR
                          $(this).text("O");
                      }else{
                          //ÍMPAR
                          $(this).text("X");
                      }
                  }
                  if(verificarganhador() == true){
                      contadorClicks = 9;
                  }
                  if(contadorClicks == 9) {
                      $(".msg").append("<br /> Jogo Encerrado");
                      clearInterval(interval);
                  }
    
                  });   
              
                  function verificarganhador(){
                      
                      var vencedor = [
                          //Linhas
                          [0, 1, 2],
                          [3, 4, 5],
                          [6, 7, 8],
                          //Colunas
                          [0, 3, 6],
                          [1, 4, 7],
                          [2, 5, 8],
                          //Diagonais
                          [0, 4, 8],
                          [6, 4, 2],        
                      ];
                      //value = ?
                      var x = new Array(9);
                      var o = new Array(9);
                      $("table td").each(function(key, value){
                          if( $(this).text() == "X"){
                              x[key] = key;
                          }
                          if( $(this).text() == "O"){
                              o[key] = key;
                          }  
                      });
                      
                    return definirganhador(x,o,vencedor);
                      
                  }
                      
                  function definirganhador(x,o,vencedor){
                          //Percorre as linhas:
                      for(var i = 0; i < vencedor.length; i++) {
                          contadorx = 0;
                          contadoro = 0;


                          //Percorre as colunas de uma linha:
                          for(var y = 0; y < vencedor[i].length; y++){
                              if(x[vencedor[i][y]] == vencedor[i][y]){
                                  contadorx++; 
                              }
                              if(o[vencedor[i][y]] == vencedor[i][y]){
                                  contadoro++;   
                              }
                              vencedor[i][y]
                          }
                          var jog1 = $("input[name=jogador1]").val();
                          var jog2 = $("input[name=jogador2]").val();
                          if(contadorx == 3){
                              $(".msg").text("X -" + jog1 + " Ganhou");
                              return true;
                          }
                          if(contadoro == 3){
                              $(".msg").text("O -" + jog2 + " Ganhou");
                              return true;

                          }
                      }
                  }
                    
          }
          var iniciojogo = null;
          function tempodecorrido(){
              if(iniciojogo == null){
                  iniciojogo = new Date();
              }
              var dataatual = new Date();
              
              var segini = iniciojogo.getSeconds();
              var segatual =dataatual.getSeconds();
              
              var minini = iniciojogo.getMinutes();
              var minatual =dataatual.getMinutes();
              
              var horaini = iniciojogo.getHours();
              var horaatual =dataatual.getHours();
              
              var timeini = iniciojogo.getTime();
              var timeatual =dataatual.getTime();

              var timedec = timeatual - timeini;
              
              var novadata = new Date(timedec);
              
              
              $("#tempo").text("Início Jogo: " + horaini + ":" + minini + ":" + segini + " Hora atual: " + horaatual+ ":" + minatual + ":" + segatual + 
                              " Tempo Decorrido: "+ novadata.getMinutes() + ":" + novadata.getSeconds());
          }
        </script>
        
        
    </head> 
    
    <body>  
        
        <div class="configurador">
            <div class="msg">
            </div>
            <span>X</span> <input type="text" name="jogador1" placeholder="Nome do jogador 1">
            x <input type="text" name="jogador2" placeholder="Nome do jogador 2">
            <span>O</span>  
            <br />
            <br/>
            <button id="btn_comecar">Começar Jogo</button>
            <br />
            <br />
        </div>  
        
        <table>
            <tr> <!-- Linha --> 
                <td></td> <!-- Coluna -->   
                <td></td>
                <td></td>
            </tr>
            <tr>    
                <td></td> 
                <td></td>
                <td></td>
            </tr>
            <tr>
                <td></td> 
                    <td></td>
                <td></td>
            </tr>
        </table>
        <div id="tempo">00:00
        </div>
    
    </body>
  

</html>
